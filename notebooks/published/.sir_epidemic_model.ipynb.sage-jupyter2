{"backend_state":"running","connection_file":"/tmp/xdg-runtime-user/jupyter/kernel-3b7499c7-f8bf-4739-9a49-305586b9e4c4.json","kernel":"python3","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"last_backend_state":1763790246913,"last_ipynb_save":1763790262922,"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.10"}},"trust":true,"type":"settings"}
{"cell_type":"code","end":1763790249073,"exec_count":3,"id":"781c22","input":"import numpy as np\nfrom scipy.integrate import odeint\nimport matplotlib.pyplot as plt\n\n# SIR model differential equations\ndef sir_model(y, t, beta, gamma):\n    \"\"\"\n    SIR model differential equations.\n    \n    Parameters:\n    -----------\n    y : array\n        Current state [S, I, R]\n    t : float\n        Current time\n    beta : float\n        Transmission rate\n    gamma : float\n        Recovery rate\n    \n    Returns:\n    --------\n    dydt : array\n        Derivatives [dS/dt, dI/dt, dR/dt]\n    \"\"\"\n    S, I, R = y\n    dSdt = -beta * S * I\n    dIdt = beta * S * I - gamma * I\n    dRdt = gamma * I\n    return [dSdt, dIdt, dRdt]","kernel":"python3","pos":1,"start":1763790246928,"state":"done","type":"cell"}
{"cell_type":"code","end":1763790249083,"exec_count":4,"id":"84396d","input":"# Model parameters\nbeta = 0.3    # Transmission rate (per day)\ngamma = 0.1   # Recovery rate (per day)\n\n# Calculate R0\nR0 = beta / gamma\nprint(f\"Basic Reproduction Number R₀ = {R0:.2f}\")\n\n# Initial conditions (fractions of population)\nI0 = 0.001    # Initial infected fraction\nR0_init = 0.0 # Initial recovered fraction\nS0 = 1.0 - I0 - R0_init  # Initial susceptible fraction\n\ny0 = [S0, I0, R0_init]\n\n# Time vector (days)\nt_max = 160\nt = np.linspace(0, t_max, 1000)\n\nprint(f\"Initial conditions: S₀ = {S0:.3f}, I₀ = {I0:.3f}, R₀ = {R0_init:.3f}\")","kernel":"python3","output":{"0":{"name":"stdout","text":"Basic Reproduction Number R₀ = 3.00\nInitial conditions: S₀ = 0.999, I₀ = 0.001, R₀ = 0.000\n"}},"pos":3,"start":1763790249079,"state":"done","type":"cell"}
{"cell_type":"code","end":1763790249094,"exec_count":5,"id":"d105d8","input":"# Solve the differential equations\nsolution = odeint(sir_model, y0, t, args=(beta, gamma))\n\n# Extract S, I, R from solution\nS = solution[:, 0]\nI = solution[:, 1]\nR = solution[:, 2]\n\n# Verify conservation law\ntotal = S + I + R\nprint(f\"Conservation check: max deviation from 1.0 = {np.max(np.abs(total - 1.0)):.2e}\")","kernel":"python3","output":{"0":{"name":"stdout","text":"Conservation check: max deviation from 1.0 = 8.88e-16\n"}},"pos":5,"start":1763790249090,"state":"done","type":"cell"}
{"cell_type":"code","end":1763790249105,"exec_count":6,"id":"3b78ad","input":"# Find peak infection\npeak_idx = np.argmax(I)\npeak_time = t[peak_idx]\npeak_infected = I[peak_idx]\n\n# Final epidemic size\nfinal_recovered = R[-1]\n\n# Herd immunity threshold\nherd_immunity = 1 - 1/R0\n\nprint(\"=\" * 50)\nprint(\"EPIDEMIC ANALYSIS RESULTS\")\nprint(\"=\" * 50)\nprint(f\"Peak infection occurs at day {peak_time:.1f}\")\nprint(f\"Peak infected fraction: {peak_infected:.4f} ({peak_infected*100:.2f}%)\")\nprint(f\"Final epidemic size: {final_recovered:.4f} ({final_recovered*100:.2f}%)\")\nprint(f\"Herd immunity threshold: {herd_immunity:.4f} ({herd_immunity*100:.2f}%)\")\nprint(f\"Final susceptible fraction: {S[-1]:.4f} ({S[-1]*100:.2f}%)\")\nprint(\"=\" * 50)","kernel":"python3","output":{"0":{"name":"stdout","text":"==================================================\nEPIDEMIC ANALYSIS RESULTS\n==================================================\nPeak infection occurs at day 38.3\nPeak infected fraction: 0.3008 (30.08%)\nFinal epidemic size: 0.9405 (94.05%)\nHerd immunity threshold: 0.6667 (66.67%)\nFinal susceptible fraction: 0.0595 (5.95%)\n==================================================\n"}},"pos":7,"start":1763790249102,"state":"done","type":"cell"}
{"cell_type":"code","end":1763790249922,"exec_count":7,"id":"c5b81d","input":"# Create figure with high resolution\nfig, ax = plt.subplots(figsize=(12, 8))\n\n# Plot S, I, R curves\nax.plot(t, S, 'b-', linewidth=2.5, label='Susceptible (S)')\nax.plot(t, I, 'r-', linewidth=2.5, label='Infected (I)')\nax.plot(t, R, 'g-', linewidth=2.5, label='Recovered (R)')\n\n# Mark peak infection\nax.axvline(x=peak_time, color='r', linestyle='--', alpha=0.5, linewidth=1.5)\nax.plot(peak_time, peak_infected, 'ro', markersize=10, \n        label=f'Peak: {peak_infected*100:.1f}% at day {peak_time:.0f}')\n\n# Add herd immunity threshold line\nax.axhline(y=herd_immunity, color='purple', linestyle=':', alpha=0.7, linewidth=1.5,\n           label=f'Herd immunity threshold: {herd_immunity*100:.1f}%')\n\n# Labels and title\nax.set_xlabel('Time (days)', fontsize=14)\nax.set_ylabel('Fraction of Population', fontsize=14)\nax.set_title(f'SIR Epidemic Model Dynamics\\n'\n             f'β = {beta}, γ = {gamma}, R₀ = {R0:.1f}', fontsize=16)\n\n# Configure legend and grid\nax.legend(loc='center right', fontsize=11)\nax.grid(True, alpha=0.3)\nax.set_xlim(0, t_max)\nax.set_ylim(0, 1.05)\n\n# Add text box with final statistics\ntextstr = f'Final Statistics:\\n' \\\n          f'Total Infected: {final_recovered*100:.1f}%\\n' \\\n          f'Remaining Susceptible: {S[-1]*100:.1f}%'\nprops = dict(boxstyle='round', facecolor='wheat', alpha=0.8)\nax.text(0.02, 0.5, textstr, transform=ax.transAxes, fontsize=11,\n        verticalalignment='center', bbox=props)\n\nplt.tight_layout()\n\n# Save the plot\nplt.savefig('plot.png', dpi=150, bbox_inches='tight')\nprint(\"Plot saved to 'plot.png'\")\n\nplt.show()","kernel":"python3","output":{"0":{"name":"stdout","text":"Plot saved to 'plot.png'\n"},"1":{"data":{"image/png":"6f1c5e5a52e7762d174ede09d6e05e4c429ed686","text/plain":"<Figure size 1200x800 with 1 Axes>"},"metadata":{"image/png":{"height":792,"width":1190}}}},"pos":9,"start":1763790249125,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"077955","input":"# SIR Epidemic Model\n\n## Introduction\n\nThe **SIR model** is a foundational compartmental model in epidemiology, first proposed by Kermack and McKendrick in 1927. It divides a population into three mutually exclusive compartments:\n\n- **S (Susceptible)**: Individuals who can contract the disease\n- **I (Infected)**: Individuals who have the disease and can transmit it\n- **R (Recovered/Removed)**: Individuals who have recovered and are immune (or deceased)\n\n## Mathematical Formulation\n\nThe dynamics are governed by the following system of ordinary differential equations:\n\n$$\\frac{dS}{dt} = -\\beta S I$$\n\n$$\\frac{dI}{dt} = \\beta S I - \\gamma I$$\n\n$$\\frac{dR}{dt} = \\gamma I$$\n\nwhere:\n- $\\beta$ is the **transmission rate** (probability of disease transmission per contact)\n- $\\gamma$ is the **recovery rate** (inverse of the infectious period)\n- $S$, $I$, $R$ are fractions of the total population $N$ (i.e., $S + I + R = 1$)\n\n## Basic Reproduction Number\n\nA critical quantity is the **basic reproduction number**:\n\n$$R_0 = \\frac{\\beta}{\\gamma}$$\n\nThis represents the average number of secondary infections produced by a single infected individual in a fully susceptible population.\n\n- If $R_0 > 1$: Epidemic outbreak occurs\n- If $R_0 < 1$: Disease dies out\n\n## Conservation Law\n\nThe total population is conserved:\n\n$$\\frac{d}{dt}(S + I + R) = 0$$\n\nThis implies $S(t) + I(t) + R(t) = N$ for all time $t$.","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"14128e","input":"## Visualization\n\nWe create a comprehensive plot showing the epidemic dynamics, including:\n- Time evolution of all three compartments\n- Peak infection marker\n- Key epidemiological parameters","pos":8,"type":"cell"}
{"cell_type":"markdown","id":"26e364","input":"## Parameter Configuration\n\nWe set up the simulation with realistic epidemiological parameters:\n\n- **Transmission rate** $\\beta = 0.3$ day$^{-1}$\n- **Recovery rate** $\\gamma = 0.1$ day$^{-1}$ (average infectious period of 10 days)\n- **Basic reproduction number** $R_0 = \\beta/\\gamma = 3.0$\n\nInitial conditions represent a population where 0.1% are initially infected.","pos":2,"type":"cell"}
{"cell_type":"markdown","id":"84569d","input":"## Numerical Solution\n\nWe solve the system using `scipy.integrate.odeint`, which employs adaptive step-size methods for accurate integration of the ODEs.","pos":4,"type":"cell"}
{"cell_type":"markdown","id":"c5bd62","input":"## Analysis of Results\n\n### Key Metrics\n\nWe compute several important epidemiological quantities:\n\n1. **Peak infection time**: When $dI/dt = 0$\n2. **Peak infected fraction**: Maximum value of $I(t)$\n3. **Final epidemic size**: $R(\\infty)$, the total fraction of population infected\n4. **Herd immunity threshold**: $1 - 1/R_0$","pos":6,"type":"cell"}
{"cell_type":"markdown","id":"e82272","input":"## Theoretical Insights\n\n### Final Size Equation\n\nThe final epidemic size $R_\\infty$ satisfies the transcendental equation:\n\n$$R_\\infty = 1 - S_0 \\exp\\left(-R_0 R_\\infty\\right)$$\n\nThis can be solved numerically to predict the total outbreak size without full simulation.\n\n### Phase Plane Analysis\n\nThe SIR model exhibits interesting phase plane dynamics. The infection grows only when:\n\n$$\\frac{dI}{dt} > 0 \\implies S > \\frac{\\gamma}{\\beta} = \\frac{1}{R_0}$$\n\nThis defines the **epidemic threshold**: an outbreak occurs only if $S_0 > 1/R_0$.\n\n## Conclusions\n\nThis simulation demonstrates the classic epidemic dynamics of the SIR model:\n\n1. The susceptible population decreases monotonically\n2. The infected population rises to a peak then declines\n3. The recovered population increases as a sigmoid curve\n4. The epidemic naturally terminates due to depletion of susceptibles\n\nThe model, despite its simplicity, captures essential features of epidemic spread and provides the foundation for more complex epidemiological models including SEIR, SEIRS, and age-structured variants.","pos":10,"type":"cell"}
{"id":0,"time":1763790235834,"type":"user"}
{"last_load":1763790236304,"type":"file"}