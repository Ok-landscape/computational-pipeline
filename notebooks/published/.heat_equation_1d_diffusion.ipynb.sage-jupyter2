{"backend_state":"running","connection_file":"/tmp/xdg-runtime-user/jupyter/kernel-4f52938d-0a11-4568-afe8-f69e6d2e5906.json","kernel":"python3","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"last_backend_state":1763835790277,"last_ipynb_save":1763839802163,"metadata":{"language_info":{"name":"python","version":"3.8.0"}},"trust":true,"type":"settings"}
{"cell_type":"code","id":"035cdc","input":"# Compute heat flux using central differences\ndef compute_heat_flux(u, dx, k=1.0):\n    \"\"\"\n    Compute heat flux q = -k * du/dx using central differences.\n    \n    Parameters:\n    -----------\n    u : ndarray\n        Temperature array (Nt x Nx)\n    dx : float\n        Spatial step size\n    k : float\n        Thermal conductivity (normalized to 1)\n    \n    Returns:\n    --------\n    q : ndarray\n        Heat flux array\n    \"\"\"\n    Nt, Nx = u.shape\n    q = np.zeros((Nt, Nx-2))\n    \n    for n in range(Nt):\n        # Central difference for interior points\n        q[n, :] = -k * (u[n, 2:] - u[n, :-2]) / (2 * dx)\n    \n    return q\n\n# Compute heat flux\nq = compute_heat_flux(u, dx)\nx_flux = x[1:-1]  # Interior points\n\n# Plot heat flux at different times\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))\n\nfor idx, n in enumerate(times_to_plot):\n    time_val = t[n]\n    ax1.plot(x_flux, q[n, :], color=colors[idx], \n             label=f't = {time_val:.2f} s', linewidth=2)\n\nax1.axhline(y=0, color='k', linestyle='--', linewidth=0.5)\nax1.set_xlabel('Position x (m)')\nax1.set_ylabel('Heat flux q (W/m²)')\nax1.set_title('Heat Flux Distribution')\nax1.legend(loc='upper right')\nax1.grid(True, alpha=0.3)\n\n# Plot boundary heat flux over time\nq_left = q[::sample_rate, 0]   # Flux near left boundary\nq_right = q[::sample_rate, -1]  # Flux near right boundary\n\nax2.plot(t_plot, q_left, 'b-', label='Left boundary', linewidth=2)\nax2.plot(t_plot, -q_right, 'r-', label='Right boundary (inverted)', linewidth=2)\nax2.set_xlabel('Time t (s)')\nax2.set_ylabel('Heat flux magnitude (W/m²)')\nax2.set_title('Heat Flux at Boundaries')\nax2.legend(loc='upper right')\nax2.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\nprint(\"Heat flows outward from the center (positive flux to the right, negative to the left)\")\nprint(\"As time progresses, the flux magnitude decreases as the temperature gradient flattens.\")","pos":15,"type":"cell"}
{"cell_type":"code","id":"663771","input":"def initial_condition_gaussian(x, A=100.0, x0=0.5, sigma=0.05):\n    \"\"\"\n    Gaussian initial temperature distribution.\n    \n    Parameters:\n    -----------\n    x : array_like\n        Spatial coordinates\n    A : float\n        Peak temperature (°C)\n    x0 : float\n        Center position (m)\n    sigma : float\n        Standard deviation (width) of the pulse\n    \n    Returns:\n    --------\n    u : array_like\n        Initial temperature distribution\n    \"\"\"\n    return A * np.exp(-(x - x0)**2 / (2 * sigma**2))\n\n# Initialize temperature array\nu = np.zeros((Nt, Nx))\nu[0, :] = initial_condition_gaussian(x)\n\n# Apply boundary conditions\nu[0, 0] = T_left\nu[0, -1] = T_right\n\nprint(f\"Initial condition: Gaussian pulse\")\nprint(f\"  Peak temperature: {np.max(u[0, :]):.1f} °C\")\nprint(f\"  Center position: x0 = {L/2} m\")","pos":5,"type":"cell"}
{"cell_type":"code","id":"6ad8ce","input":"# Import required libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nfrom mpl_toolkits.mplot3d import Axes3D\n\n# Set up matplotlib for publication-quality figures\nplt.rcParams['figure.figsize'] = [12, 8]\nplt.rcParams['font.size'] = 12\nplt.rcParams['lines.linewidth'] = 2","pos":1,"type":"cell"}
{"cell_type":"code","id":"a737ba","input":"# Calculate total heat content over time (integral of temperature)\ntotal_heat = np.trapz(u, x, axis=1)\n\n# Peak temperature over time\npeak_temp = np.max(u, axis=1)\n\n# Characteristic diffusion length\nL_diff = np.sqrt(2 * alpha * t_end)\n\nprint(\"Physical Analysis:\")\nprint(\"=\"*50)\nprint(f\"\\nCharacteristic diffusion length: L_diff = sqrt(2*alpha*t)\")\nprint(f\"  At t = {t_end} s: L_diff = {L_diff:.4f} m\")\nprint(f\"  This is {L_diff/L*100:.1f}% of the rod length\")\n\nprint(f\"\\nTotal heat content (proportional to integral of u):\")\nprint(f\"  Initial: {total_heat[0]:.2f}\")\nprint(f\"  Final:   {total_heat[-1]:.2f}\")\nprint(f\"  Ratio:   {total_heat[-1]/total_heat[0]:.4f}\")\nprint(f\"  (Heat loss due to boundary conditions)\")\n\nprint(f\"\\nPeak temperature decay:\")\nprint(f\"  Initial: {peak_temp[0]:.2f} °C\")\nprint(f\"  Final:   {peak_temp[-1]:.2f} °C\")\n\n# Theoretical peak decay for infinite domain: u_max ~ 1/sqrt(t)\nprint(f\"\\nTheoretical scaling (infinite domain):\")\nprint(f\"  u_max ~ 1/sqrt(t) at long times\")\n\n# Verify numerical accuracy\nt_check = 0.5\nn_check = int(t_check / dt)\nu_num = u[n_check, :]\nu_ana = analytical_solution_gaussian(x, t_check, alpha=alpha)\nrel_error = np.max(np.abs(u_num - u_ana)) / np.max(u_ana) * 100\n\nprint(f\"\\nNumerical accuracy at t = {t_check} s:\")\nprint(f\"  Max relative error: {rel_error:.2f}%\")\nprint(f\"  (Error increases near boundaries due to finite domain)\")","pos":13,"type":"cell"}
{"cell_type":"code","id":"c7612f","input":"def analytical_solution_gaussian(x, t, A=100.0, x0=0.5, sigma=0.05, alpha=0.01):\n    \"\"\"\n    Analytical solution for Gaussian initial condition (infinite domain).\n    \n    Parameters:\n    -----------\n    x : array_like\n        Spatial coordinates\n    t : float\n        Time\n    A : float\n        Initial peak temperature\n    x0 : float\n        Center position\n    sigma : float\n        Initial standard deviation\n    alpha : float\n        Thermal diffusivity\n    \n    Returns:\n    --------\n    u : array_like\n        Temperature distribution at time t\n    \"\"\"\n    if t == 0:\n        return A * np.exp(-(x - x0)**2 / (2 * sigma**2))\n    \n    sigma_t = np.sqrt(sigma**2 + 2 * alpha * t)\n    return A * sigma / sigma_t * np.exp(-(x - x0)**2 / (2 * sigma_t**2))\n\n# Calculate analytical solution at selected times (for comparison)\nt_compare = [0.0, 0.1, 0.5, 1.0, 2.0]\nu_analytical = {}\nfor tc in t_compare:\n    u_analytical[tc] = analytical_solution_gaussian(x, tc, alpha=alpha)\n\nprint(\"Analytical solutions computed for comparison times.\")","pos":9,"type":"cell"}
{"cell_type":"code","id":"d45d0d","input":"# Create comprehensive visualization\nfig = plt.figure(figsize=(16, 12))\n\n# Plot 1: Temperature profiles at different times\nax1 = fig.add_subplot(2, 2, 1)\ntimes_to_plot = [0, int(Nt*0.05), int(Nt*0.25), int(Nt*0.5), Nt-1]\ncolors = plt.cm.viridis(np.linspace(0, 1, len(times_to_plot)))\n\nfor idx, n in enumerate(times_to_plot):\n    time_val = t[n]\n    ax1.plot(x, u[n, :], color=colors[idx], \n             label=f't = {time_val:.2f} s', linewidth=2)\n\nax1.set_xlabel('Position x (m)')\nax1.set_ylabel('Temperature u(x,t) (°C)')\nax1.set_title('Temperature Profiles at Different Times')\nax1.legend(loc='upper right')\nax1.grid(True, alpha=0.3)\n\n# Plot 2: Space-time contour plot\nax2 = fig.add_subplot(2, 2, 2)\n# Sample every nth time step for cleaner plot\nsample_rate = max(1, Nt // 200)\nt_sampled = t[::sample_rate]\nu_sampled = u[::sample_rate, :]\nX, T = np.meshgrid(x, t_sampled)\n\ncontour = ax2.contourf(X, T, u_sampled, levels=50, cmap='hot')\ncbar = plt.colorbar(contour, ax=ax2)\ncbar.set_label('Temperature (°C)')\nax2.set_xlabel('Position x (m)')\nax2.set_ylabel('Time t (s)')\nax2.set_title('Space-Time Temperature Distribution')\n\n# Plot 3: Numerical vs Analytical comparison\nax3 = fig.add_subplot(2, 2, 3)\ncomparison_times = [0.1, 0.5, 1.0]\nmarkers = ['o', 's', '^']\n\nfor tc, marker in zip(comparison_times, markers):\n    n_idx = int(tc / dt)\n    if n_idx < Nt:\n        # Numerical solution (sampled points)\n        sample_pts = np.arange(0, Nx, 10)\n        ax3.plot(x[sample_pts], u[n_idx, sample_pts], marker=marker, \n                 linestyle='none', markersize=6, \n                 label=f'Numerical t={tc}s')\n        # Analytical solution\n        ax3.plot(x, u_analytical[tc], linestyle='-', linewidth=1.5,\n                 label=f'Analytical t={tc}s')\n\nax3.set_xlabel('Position x (m)')\nax3.set_ylabel('Temperature u(x,t) (°C)')\nax3.set_title('Numerical vs Analytical Solution')\nax3.legend(loc='upper right', fontsize=9)\nax3.grid(True, alpha=0.3)\n\n# Plot 4: Heat flux and temperature at center\nax4 = fig.add_subplot(2, 2, 4)\n\n# Temperature at center point over time\ncenter_idx = Nx // 2\nt_plot = t[::sample_rate]\nu_center = u[::sample_rate, center_idx]\n\nax4.plot(t_plot, u_center, 'b-', linewidth=2, label='Temperature at x=L/2')\n\n# Also plot analytical decay\nu_center_analytical = [analytical_solution_gaussian(L/2, ti, alpha=alpha) for ti in t_plot]\nax4.plot(t_plot, u_center_analytical, 'r--', linewidth=2, \n         label='Analytical (infinite domain)')\n\nax4.set_xlabel('Time t (s)')\nax4.set_ylabel('Temperature (°C)')\nax4.set_title('Temperature Evolution at Rod Center')\nax4.legend(loc='upper right')\nax4.grid(True, alpha=0.3)\n\nplt.tight_layout()\n\n# Save the figure\nplt.savefig('plot.png', dpi=150, bbox_inches='tight')\nprint(\"Figure saved as 'plot.png'\")\n\nplt.show()","pos":11,"type":"cell"}
{"cell_type":"code","id":"d4be97","input":"def solve_heat_equation_ftcs(u, r, Nt, T_left, T_right):\n    \"\"\"\n    Solve 1D heat equation using FTCS finite difference method.\n    \n    Parameters:\n    -----------\n    u : ndarray\n        Temperature array (Nt x Nx), with initial condition in u[0, :]\n    r : float\n        Fourier number (alpha * dt / dx^2)\n    Nt : int\n        Number of time steps\n    T_left : float\n        Left boundary temperature\n    T_right : float\n        Right boundary temperature\n    \n    Returns:\n    --------\n    u : ndarray\n        Solution array with temperature at all times and positions\n    \"\"\"\n    Nx = u.shape[1]\n    \n    for n in range(0, Nt - 1):\n        # Update interior points using FTCS scheme\n        for i in range(1, Nx - 1):\n            u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])\n        \n        # Apply Dirichlet boundary conditions\n        u[n+1, 0] = T_left\n        u[n+1, -1] = T_right\n    \n    return u\n\n# Solve the heat equation\nu = solve_heat_equation_ftcs(u, r, Nt, T_left, T_right)\n\nprint(\"Heat equation solved successfully!\")\nprint(f\"Solution shape: {u.shape} (time steps x spatial points)\")","pos":7,"type":"cell"}
{"cell_type":"code","id":"e21221","input":"# Physical parameters\nL = 1.0          # Length of the rod (m)\nalpha = 0.01     # Thermal diffusivity (m^2/s) - typical for metals\nT_left = 0.0     # Left boundary temperature (°C)\nT_right = 0.0    # Right boundary temperature (°C)\n\n# Discretization parameters\nNx = 101         # Number of spatial points\ndx = L / (Nx - 1)  # Spatial step size\n\n# Time parameters - ensure stability\nt_end = 2.0      # Total simulation time (s)\nr = 0.4          # Fourier number (must be <= 0.5 for stability)\ndt = r * dx**2 / alpha  # Time step from stability criterion\nNt = int(t_end / dt) + 1  # Number of time steps\n\n# Create spatial and temporal grids\nx = np.linspace(0, L, Nx)\nt = np.linspace(0, t_end, Nt)\n\nprint(\"Simulation Parameters:\")\nprint(f\"  Rod length: L = {L} m\")\nprint(f\"  Thermal diffusivity: alpha = {alpha} m²/s\")\nprint(f\"  Spatial points: Nx = {Nx}\")\nprint(f\"  Spatial step: dx = {dx:.4f} m\")\nprint(f\"  Time step: dt = {dt:.6f} s\")\nprint(f\"  Number of time steps: Nt = {Nt}\")\nprint(f\"  Fourier number: r = {r:.2f} (stable if <= 0.5)\")\nprint(f\"  Total simulation time: {t_end} s\")","pos":3,"type":"cell"}
{"cell_type":"markdown","id":"2362ac","input":"## Physical Parameters and Discretization\n\nWe simulate heat diffusion in a 1-meter rod with fixed temperature boundary conditions. The initial temperature distribution is a localized heat pulse (Gaussian) in the center.","pos":2,"type":"cell"}
{"cell_type":"markdown","id":"28be65","input":"# Heat Equation: 1D Diffusion\n\n## Theoretical Background\n\nThe heat equation is one of the most fundamental partial differential equations (PDEs) in mathematical physics, describing how heat (or any diffusive quantity) propagates through a medium over time. It was first formulated by Joseph Fourier in 1822 and remains central to thermal engineering, materials science, and mathematical analysis.\n\n### The Governing Equation\n\nThe one-dimensional heat equation is:\n\n$$\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$$\n\nwhere:\n- $u(x, t)$ is the temperature at position $x$ and time $t$\n- $\\alpha$ is the thermal diffusivity (m²/s), defined as $\\alpha = \\frac{k}{\\rho c_p}$\n  - $k$ = thermal conductivity (W/m·K)\n  - $\\rho$ = density (kg/m³)\n  - $c_p$ = specific heat capacity (J/kg·K)\n\n### Physical Interpretation\n\nThe heat equation states that the rate of temperature change at a point is proportional to the spatial curvature of the temperature profile:\n- Where $\\frac{\\partial^2 u}{\\partial x^2} > 0$ (concave up), temperature increases\n- Where $\\frac{\\partial^2 u}{\\partial x^2} < 0$ (concave down), temperature decreases\n- Heat flows from hot to cold regions, smoothing out temperature gradients\n\n### Boundary Conditions\n\nWe consider a rod of length $L$ with:\n- **Dirichlet conditions**: Fixed temperatures at boundaries ($u(0,t) = T_0$, $u(L,t) = T_L$)\n- **Neumann conditions**: Fixed heat flux at boundaries ($\\frac{\\partial u}{\\partial x} = q$)\n- **Periodic conditions**: $u(0,t) = u(L,t)$\n\n### Numerical Method: Finite Differences\n\nWe discretize the equation using the **Forward-Time Central-Space (FTCS)** scheme:\n\n$$\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\alpha \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{\\Delta x^2}$$\n\nRearranging:\n\n$$u_i^{n+1} = u_i^n + r(u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\n\nwhere $r = \\frac{\\alpha \\Delta t}{\\Delta x^2}$ is the **Fourier number** (or mesh ratio).\n\n### Stability Criterion\n\nThe FTCS scheme is **conditionally stable**. For stability, we require:\n\n$$r = \\frac{\\alpha \\Delta t}{\\Delta x^2} \\leq \\frac{1}{2}$$\n\nThis is the **Von Neumann stability condition**.","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"2f3eb5","input":"## Heat Flux Analysis\n\nAccording to Fourier's Law, the heat flux is proportional to the temperature gradient:\n\n$$q = -k \\frac{\\partial u}{\\partial x}$$\n\nLet's compute and visualize the heat flux distribution.","pos":14,"type":"cell"}
{"cell_type":"markdown","id":"534666","input":"## Conclusion\n\nThis simulation demonstrates the fundamental physics of heat diffusion in one dimension:\n\n### Key Observations\n\n1. **Diffusive Spreading**: The initial Gaussian pulse spreads over time, with its width growing as $\\sqrt{t}$ and amplitude decaying as $1/\\sqrt{t}$. This is the hallmark of diffusive processes.\n\n2. **Boundary Effects**: The Dirichlet boundary conditions (fixed temperature at boundaries) cause heat to flow out of the system, reducing the total thermal energy over time.\n\n3. **Numerical Stability**: The FTCS scheme with $r \\leq 0.5$ provides stable and accurate solutions. Larger time steps would cause numerical instabilities.\n\n4. **Heat Flux**: The heat flux is maximum where the temperature gradient is steepest (near the center initially), and decays as the profile smooths out.\n\n### Physical Applications\n\nThe 1D heat equation models:\n- **Thermal processing**: Heat treatment of metals, casting, welding\n- **Building physics**: Heat flow through walls and insulation\n- **Geophysics**: Heat flow in the Earth's crust\n- **Biology**: Thermal diffusion in tissue\n\n### Mathematical Significance\n\nThe heat equation is the prototypical **parabolic PDE**, with properties shared by many diffusive systems including:\n- Mass diffusion (Fick's law)\n- Brownian motion (probability diffusion)\n- Financial models (Black-Scholes equation)\n\nThe explicit FTCS method demonstrated here is simple but conditionally stable. For practical applications with stiff problems or long time scales, implicit methods (Crank-Nicolson, backward Euler) are preferred.","pos":16,"type":"cell"}
{"cell_type":"markdown","id":"63cac0","input":"## Initial Condition: Gaussian Heat Pulse\n\nWe initialize the temperature distribution as a Gaussian pulse centered at $x_0 = L/2$:\n\n$$u(x, 0) = A \\exp\\left(-\\frac{(x - x_0)^2}{2\\sigma^2}\\right)$$\n\nThis models a localized heat source that will diffuse over time.","pos":4,"type":"cell"}
{"cell_type":"markdown","id":"6fd796","input":"## Quantitative Analysis\n\nLet's analyze key physical quantities: total heat content, peak temperature decay, and diffusion length scale.","pos":12,"type":"cell"}
{"cell_type":"markdown","id":"7f8402","input":"## Numerical Solution: FTCS Method\n\nWe implement the Forward-Time Central-Space (FTCS) finite difference scheme to solve the heat equation numerically.","pos":6,"type":"cell"}
{"cell_type":"markdown","id":"8ae0f1","input":"## Visualization: Temperature Evolution","pos":10,"type":"cell"}
{"cell_type":"markdown","id":"f86079","input":"## Analytical Solution for Comparison\n\nFor a Gaussian initial condition with homogeneous Dirichlet boundary conditions on an infinite domain, the analytical solution is:\n\n$$u(x, t) = \\frac{A\\sigma}{\\sqrt{\\sigma^2 + 2\\alpha t}} \\exp\\left(-\\frac{(x - x_0)^2}{2(\\sigma^2 + 2\\alpha t)}\\right)$$\n\nThis shows the characteristic diffusive spreading: the pulse widens as $\\sqrt{t}$ while its amplitude decreases as $1/\\sqrt{t}$.","pos":8,"type":"cell"}
{"id":0,"time":1763835787313,"type":"user"}
{"last_load":1763836558078,"type":"file"}